## åº”ç”¨é“¾æŒ‡å—

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å’Œå®è·µå¦‚ä½•å°†åº”ç”¨é“¾æ¥å…¥ç« é±¼ç½‘ç»œã€‚

* æ³¨å†Œåº”ç”¨é“¾
* é›†æˆåº”ç”¨é“¾

### æ³¨å†Œåº”ç”¨é“¾

**éœ€è¦åšä»€ä¹ˆ**

* åˆ›å»º NEAR å¸æˆ·
* ç”³è¯· OCT
* æ³¨å†Œåº”ç”¨é“¾

#### åˆ›å»º Near è´¦æˆ·

ç« é±¼ç½‘ç»œæ˜¯åœ¨ NEAR åŒºå—é“¾ç½‘ç»œä¸Šè¿è¡Œçš„ä¸€ä¸ªåº”ç”¨é“¾ç½‘ç»œã€‚å› æ­¤ï¼Œåº”ç”¨é“¾å›¢é˜Ÿé¦–å…ˆéœ€è¦æ‹¥æœ‰ä¸€ä¸ª NEAR ç½‘ç»œä¸Šå¸æˆ·ï¼Œè¿™æ ·æ‰èƒ½å®Œæˆåº”ç”¨é“¾æ¥å…¥ç« é±¼ç½‘ç»œçš„æ“ä½œã€‚

åœ¨ NEAR ä¸Šåˆ›å»ºå¸æˆ·æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ NEAR é’±åŒ…ã€‚æ‰“å¼€ NEAR [æµ‹è¯•ç½‘é’±åŒ…é“¾æ¥](https://wallet.testnet.near.org)ï¼ŒæŒ‰ç…§è¯´æ˜åˆ›å»ºå¸æˆ·ã€‚

æ›´å¤šè¯¦ç»†ä¿¡æ¯å‚è€ƒ[åˆ›å»ºNEARå¸æˆ·](https://docs.near.org/docs/develop/basics/create-account)ã€‚

#### ç”³è¯· OCT

åŠ å…¥ç« é±¼ç½‘ç»œçš„[Discord](https://discord.gg/6GTJBkZA9Q)ï¼Œåœ¨ **#testnet** é¢‘é“ä¸­ï¼Œå¯ä»¥ç”³è¯· OCT ç”¨äºæµ‹è¯•ï¼Œå›¢é˜Ÿæˆå‘˜ä¼šä¸ºä½ æä¾›å¸®åŠ©ã€‚

#### æ³¨å†Œåº”ç”¨é“¾

ç« é±¼ç½‘ç»œçš„æ¶æ„ä¸­ï¼Œæœ‰ä¸€ä¸ªéƒ¨ç½²åœ¨ NEAR åŒºå—é“¾ç½‘ç»œä¸­çš„ä¸­ç»§åˆçº¦ã€‚åº”ç”¨é“¾å›¢é˜Ÿå¯ä»¥ç”¨ NEAR å¸æˆ·å‘ä¸­ç»§åˆçº¦å‘é€ä¸€ç¬”æ³¨å†Œäº¤æ˜“ï¼Œè¯¥äº¤æ˜“åŒ…å«äº†åº”ç”¨é“¾çš„ä¿¡æ¯ï¼Œäº¤æ˜“æˆåŠŸåä¼šè¿”å›åº”ç”¨é“¾çš„**appchain_id**ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š

* é¦–å…ˆç”¨ NEAR å¸æˆ·ç™»å½•åˆ°ç« é±¼ç½‘ç»œçš„[æµ‹è¯•ç½‘](https://testnet.oct.network/)ã€‚
* å…¶æ¬¡ç‚¹å‡» **Register** æŒ‰é’®ï¼Œè¾“å…¥ *Appchain Name, Bond Token*ï¼›
* ç„¶åç‚¹å‡» *Register* å‘é€æ³¨å†Œäº¤æ˜“ï¼Œäº¤æ˜“æˆåŠŸå®Œæˆåï¼Œé¡µé¢ä¸­çš„äº¤æ˜“*ID* åˆ™ä½œä¸ºåº”ç”¨é“¾çš„**appchain_id**ã€‚

### é›†æˆåº”ç”¨é“¾

**éœ€è¦åšä»€ä¹ˆ**

* æ›´æ–°åº”ç”¨é“¾ä»£ç 
* ç”Ÿæˆå¹¶æ›´æ–°**Chain Spec**æ–‡ä»¶
* æä¾›**Chain Spec**æ–‡ä»¶çš„é“¾æ¥å’Œå“ˆå¸Œ

#### æ›´æ–°åº”ç”¨é“¾ä»£ç 

é›†æˆåº”ç”¨é“¾çš„ç¬¬ä¸€æ­¥æ˜¯å¼•å…¥*pallet-octopus-appchain*ï¼Œå¹¶æ›´æ–°åŸºäºSubstrateçš„åº”ç”¨é“¾ä»£ç ã€‚

1. åœ¨ Runtime çš„`Cargo.toml`æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä¾èµ–é¡¹ï¼š

```TOML
[dependencies]
pallet-session = { default-features = false, version = '3.0.0' }
pallet-octopus-appchain = { default-features = false, git = 'https://github.com/octopus-network/pallet-octopus-appchain.git' }
```

æ›´æ–° Runtime çš„ â€œstdâ€ åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ palletï¼š

```TOML
std = [
    # --snip--
    'pallet-session/std',
    'pallet-octopus-appchain/std',
]
```

2. æ›´æ–° Runtime çš„`lib.rs`æ–‡ä»¶ï¼Œå‚è€ƒå¦‚ä¸‹ä»£ç å®ç°å…¶ traitï¼š


```rust
parameter_types! {
	pub const AppchainId: pallet_octopus_appchain::ChainId = 3;
	pub const Motherchain: pallet_octopus_appchain::MotherchainType = pallet_octopus_appchain::MotherchainType::NEAR;
	pub const GracePeriod: u32 = 5;
	pub const UnsignedPriority: u64 = 1 << 20;
}

impl pallet_octopus_appchain::Config for Runtime {
	type Event = Event;
	type AuthorityId = pallet_octopus_appchain::crypto::OctopusAuthId;
	type Call = Call;
	type AppchainId = AppchainId;
	type Motherchain = Motherchain;
	const RELAY_CONTRACT_NAME: &'static [u8] = b"dev-1618284355026-5339538";
	type GracePeriod = GracePeriod;
	type UnsignedPriority = UnsignedPriority;
}
```

åŒæ—¶ï¼Œæ›´æ”¹å¸¸é‡**AppchainId**çš„å€¼ï¼ŒAppchain ID æ˜¯åœ¨ Octopus [testnet](https://testnet.oct.network/) ä¸­æ³¨å†Œ Appchain æ—¶ç”Ÿæˆçš„ã€‚

```Rust
pub const AppchainId: pallet_octopus_appchain::ChainId = 3;
```

æ›´æ”¹å¸¸é‡**RELAY_CONTRACT_NAME**çš„å€¼ï¼Œä» Octopus [testnet](https://testnet.oct.network/)æŸ¥çœ‹è·å¾—ï¼Œä¾‹å¦‚ï¼šoct-relay.testnet

```Rust
const RELAY_CONTRACT_NAME: &'static [u8] = b"oct-relay.testnet";
```

3. å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°çš„å®`construct_runtime!`ä¸­ï¼š

```rust
OctopusAppchain: pallet_octopus_appchain::{Module, Call, Storage, Config<T>, Event<T>, ValidateUnsigned},
```

å¯ä»¥æŸ¥çœ‹[Barnacle](https://github.com/octopus-network/barnacle)çš„æœ€åä¸€æ¬¡æäº¤ä»¥è¿›è¡Œæ‰€æœ‰æ›´æ”¹ã€‚

#### ç”Ÿæˆå¹¶æ›´æ–°Chain Specæ–‡ä»¶

1. é¦–å…ˆéœ€è¦ç”Ÿæˆ chainspec æ–‡ä»¶ï¼Œç¤ºä¾‹å‘½ä»¤å¦‚ä¸‹ï¼š

   ```bash
   ./target/debug/node-template build-spec --disable-default-bootnode --chain local > chain-spec.json
   ```

    æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒ Substrate å¼€å‘æ–‡æ¡£ [Create a Custom Chain Spec](https://substrate.dev/docs/en/tutorials/start-a-private-network/customspec)

2. å…¶æ¬¡ï¼Œå¯ä»¥ä»Octopus [testnet](https://testnet.oct.network/) ä¸‹è½½ chainspec ä»£ç æ®µã€‚

3. ç„¶ååŸºäºä¸‹è½½çš„ chainspec ä»£ç ç‰‡æ®µï¼Œæ›´æ–°å¦‚ä¸‹å­—æ®µç”Ÿæˆåº”ç”¨é“¾çš„ chainspec æ–‡ä»¶ã€‚

   * `palletBalance`
   * `palletSession`
   * `palletOctopusAppchain`

   ç”Ÿæˆ raw chainspecï¼Œç¤ºä¾‹å‘½ä»¤å¦‚ä¸‹ï¼š

   ```bash
   ./target/debug/node-template build-spec --chain=chain-spec.json --raw --disable-default-bootnode > chain-spec-raw.json
   ```

4. æœ€åç”Ÿæˆ chainspec æ–‡ä»¶çš„å“ˆå¸Œï¼Œç¤ºä¾‹å‘½ä»¤å¦‚ä¸‹ï¼š

   ```bash
   # unix
   sha256sum chain-spec-raw.json
   ```

#### æä¾›Chain Specæ–‡ä»¶çš„é“¾æ¥å’Œå“ˆå¸Œ

å¯åŠ¨ç½‘ç»œéœ€è¦åº”ç”¨é“¾å›¢é˜Ÿæä¾›åº”ç”¨é“¾çš„ chainspec æ–‡ä»¶ã€‚å¯ä»¥å°†å…¶ä¸Šä¼ åˆ°ç½‘ä¸Šï¼Œæ¯”å¦‚ï¼šé¡¹ç›®çš„ Githubï¼Œç„¶åç™»å½•åˆ° Octopus [testnet](https://testnet.oct.network/) å¡«å†™æ–‡ä»¶ URL å’Œå“ˆå¸Œã€‚

æœ€åå¯åŠ¨ç½‘ç»œï¼Œé€šè¿‡ç« é±¼ç½‘ç»œçš„[Discord](https://discord.gg/6GTJBkZA9Q) çš„ #testnet é¢‘é“ä¸ç« é±¼å›¢é˜Ÿè”ç³»ã€‚

ğŸ‰ğŸ‰ğŸ‰æ­å–œï¼æˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ°åº”ç”¨é“¾å›¢é˜Ÿå¯ä»¥ä½¿ç”¨è¿™é¡¹ä»¤äººå…´å¥‹çš„æŠ€æœ¯å…±åŒæ„å»º Web3.0ï¼å¦‚æœè¿˜æœ‰å…¶å®ƒç–‘é—®ï¼Œè¯·éšæ—¶åœ¨ Discord ä¸Šä¸æˆ‘ä»¬èŠå¤©ï¼æˆ‘ä»¬å°†å›å¤æ‚¨çš„æ‰€æœ‰ä¿¡æ¯ğŸ¤Ÿ